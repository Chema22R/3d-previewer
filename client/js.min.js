"use strict";function controller3D(){function e(){requestAnimationFrame(e),i.render(n,o)}function t(e,t){if("stl"===t.type){if(t.vertices.length>0&&e.addAttribute("position",new THREE.BufferAttribute(new Float32Array(t.vertices),3)),t.normals.length>0){for(var n=[],o=0;o<t.normals.length;o+=3)n.push(t.normals[o],t.normals[o+1],t.normals[o+2]),n.push(t.normals[o],t.normals[o+1],t.normals[o+2]),n.push(t.normals[o],t.normals[o+1],t.normals[o+2]);e.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(n),3))}}else"ply"===t.type?(t.indices.length>0&&e.setIndex(t.indices),t.vertices.length>0&&e.addAttribute("position",new THREE.Float32BufferAttribute(t.vertices,3)),t.normals.length>0&&e.addAttribute("normal",new THREE.Float32BufferAttribute(t.normals,3)),e.computeBoundingSphere()):"obj"===t.type&&(t.vertices.length>0&&e.addAttribute("position",new THREE.Float32BufferAttribute(t.vertices,3)),t.normals.length>0&&e.addAttribute("normal",new THREE.Float32BufferAttribute(t.normals,3)));return e}var n,o,r,i,a,s,c,l,u,p,h,d=$(".previewControl.wrapper"),f=new CP(document.querySelector(".palette.icon")).set("#aaaaaa");this.init=function(){n=new THREE.Scene,o=new THREE.PerspectiveCamera(75,d.width()/d.height(),1,1e3),o.position.set(0,0,100),n.add(o),r=new THREE.HemisphereLight(16777215,0,1),o.add(r),i=new THREE.WebGLRenderer({canvas:$("canvas.previewControl").get(0),antialias:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(d.width(),d.height()),i.setClearColor(2105376),a=new THREE.OrbitControls(o,i.domElement),s=new THREE.MeshPhongMaterial({color:11184810,shading:THREE.FlatShading,wireframe:!1}),c=new THREE.MeshBasicMaterial({color:11184810,shading:THREE.SmoothShading,wireframe:!0,wireframeLinewidth:1}),l=new THREE.Box3,e()},this.loadMesh=function(e){if(p?(n.remove(p),f.set("#aaaaaa"),s.color.setHex("0xaaaaaa"),c.color.setHex("0xaaaaaa")):$(".navbar.right").fadeIn("slow"),a.reset(),u=t(new THREE.BufferGeometry,e),u.center(),p=new THREE.Mesh(u,s),h=l.setFromObject(p).getSize(),h.x<100&&h.y<100&&h.z<100||h.x>100||h.y>100||h.z>100){var o=h.x;o<h.y&&(o=h.y),o<h.z&&(o=h.z),p.scale.multiplyScalar(100/o)}n.add(p)},$(window).resize(function(){o.aspect=d.width()/d.height(),o.updateProjectionMatrix(),i.setSize(d.width(),d.height())}),$(".navbar.right .reset.icon").click(function(e){e.preventDefault(),p.rotation.x=0,p.rotation.y=0,p.rotation.z=0,a.reset()}),$(".rotatorArrows *").click(function(e){e.preventDefault();var t=new THREE.Matrix4;switch($(this).attr("class").split(" ")[0]){case"icon-arrow-up":t.makeRotationAxis(new THREE.Vector3(1,0,0).normalize(),Math.PI/2);break;case"icon-arrow-down":t.makeRotationAxis(new THREE.Vector3(1,0,0).normalize(),-Math.PI/2);break;case"icon-arrow-right":t.makeRotationAxis(new THREE.Vector3(0,1,0).normalize(),-Math.PI/2);break;case"icon-arrow-left":t.makeRotationAxis(new THREE.Vector3(0,1,0).normalize(),Math.PI/2)}p.matrix=t.multiply(p.matrix),p.rotation.setFromRotationMatrix(p.matrix)}),$(".navbar.right .wireframe.icon").click(function(e){e.preventDefault(),p.material.uuid===s.uuid?p.material=c:p.material=s}),f.on("change",function(e){p&&(s.color.setHex("0x"+e),c.color.setHex("0x"+e))})}var controller3D,serverAddress="localhost",serverPort="8081";$(function(){function e(e){var t=["stl","ply","obj"];for(i=0;i<t.length;i++)if(t[i]==e.toLowerCase())return!0;return!1}function t(e,t){$(".stateMessage").text(e).css({color:"white",background:t}).fadeIn("slow",function(){setTimeout(function(){$(".stateMessage").fadeOut("slow")},2e3)})}$(".navbar.top input[type='file'].fileUpload").change(function(n){n.preventDefault();var o=$(this).get(0).files[0];if(e(o.name.substring(o.name.lastIndexOf(".")+1))){var r=new FormData;r.append("file",o),$(".loadingBar.wrapper").fadeIn("slow"),$.ajax({url:"http://"+serverAddress+":"+serverPort+"/file",method:"POST",data:r,processData:!1,contentType:!1,success:function(e,n){$(".loadingBar.wrapper").fadeOut("slow"),t("File uploaded successfully","green"),controller3D.loadMesh(e)},error:function(e,n,o){$(".loadingBar.wrapper").fadeOut("slow"),t(o?e.responseText:"Unable to connect to server","red")}})}else t("Extension not supported. You can use stl, ply, obj","red")})}),$(function(){function e(e){if(0==e.length)$(".fileList.entries").css("padding","30px").text("No hay elementos para mostrar");else{$(".fileList.entries").css("padding","0px");for(var n=0;n<e.length;n++)$("<div class='"+e[n]._id+" fileList entry'><div class='"+e[n]._id+" fileList info pointer' title='"+e[n].name+"'><p class='fileList name'>"+e[n].name+"</p><p class='fileList date'>"+new Date(e[n].date).toLocaleString()+"</p></div><span class='"+e[n]._id+" fileList icon-delete pointer' title='delete "+e[n].name+"'></span></div>").appendTo(".fileList.entries")}$(".fileList.menu").fadeIn("slow"),setTimeout(function(){$(".fileList.menu").scrollTop(0),t()},10)}function t(){$(".fileList.menu .fileList.info").click(function(e){e.preventDefault();var t=$(this).attr("class").split(" ")[0],o=this.parentNode.parentNode;$(".loadingBar.wrapper").fadeIn("slow"),$.ajax({url:"http://"+serverAddress+":"+serverPort+"/file/"+t,method:"GET",success:function(e,t){$(".loadingBar.wrapper").fadeOut("slow"),$(".fileList.menu").fadeOut("slow",function(){for(;o.childNodes.length>0;)o.childNodes[0].remove();$(".fileList.menu .fileList.search").val("")}),controller3D.loadMesh(e)},error:function(e,t,o){$(".loadingBar.wrapper").fadeOut("slow"),n(o?e.responseText:"Unable to connect to server","red")}})}),$(".fileList.menu .fileList.icon-delete").click(function(e){e.preventDefault();var t=$(this).attr("class").split(" ")[0],o=this.parentNode;$.ajax({url:"http://"+serverAddress+":"+serverPort+"/file/"+t,method:"DELETE",success:function(e,t){$(o).hide(400,"linear",function(){o.remove()})},error:function(e,t,o){n(o?e.responseText:"Unable to connect to server","red")}})})}function n(e,t){$(".stateMessage").text(e).css({color:"white",background:t}).fadeIn("slow",function(){setTimeout(function(){$(".stateMessage").fadeOut("slow")},2e3)})}$(".navbar.top .fileList.icon").click(function(t){t.preventDefault(),$.ajax({url:"http://"+serverAddress+":"+serverPort+"/file",method:"GET",success:function(t,n){e(t)},error:function(e,t,o){n(o?e.responseText:"Unable to connect to server","red")}})}),$(window).on("mousedown touchstart",function(e){if(!$(e.target).is(".fileList")&&"none"!=$(".fileList.menu").css("display")){var t=$(".fileList.entries")[0];$(".fileList.menu").fadeOut("slow",function(){for(;t.childNodes.length>0;)t.childNodes[0].remove();$(".fileList.menu .fileList.search").val("")})}}),$(".fileList.menu .fileList.search").on("input propertychange change",function(e){e.preventDefault();var t=$(this).val().toLowerCase().trim();$(".fileList.name").html(function(e,n){n.toLowerCase().includes(t)?$(this).parent().parent().show():$(this).parent().parent().hide()}),$(".fileList.date").html(function(e,n){n.toLowerCase().includes(t)&&$(this).parent().parent().show()})})}),function(e,t){function n(e){return void 0!==e}function o(e){return"string"==typeof e}function r(e){return"object"==typeof e}function i(e){return Object.keys(e).length}function a(e,t,n){return e<t?t:e>n?n:e}function s(e,t){return parseInt(e,t||10)}function c(e){return Math.round(e)}function l(e){var t,n,o,r,i,a,s,l,u=+e[0],p=+e[1],h=+e[2];switch(r=Math.floor(6*u),i=6*u-r,a=h*(1-p),s=h*(1-i*p),l=h*(1-(1-i)*p),r=r||0,s=s||0,l=l||0,r%6){case 0:t=h,n=l,o=a;break;case 1:t=s,n=h,o=a;break;case 2:t=a,n=h,o=l;break;case 3:t=a,n=s,o=h;break;case 4:t=l,n=a,o=h;break;case 5:t=h,n=a,o=s}return[c(255*t),c(255*n),c(255*o)]}function u(e){return h(l(e))}function p(e){var t,n=+e[0],o=+e[1],r=+e[2],i=Math.max(n,o,r),a=Math.min(n,o,r),s=i-a,c=0===i?0:s/i,l=i/255;switch(i){case a:t=0;break;case n:t=o-r+s*(o<r?6:0),t/=6*s;break;case o:t=r-n+2*s,t/=6*s;break;case r:t=n-o+4*s,t/=6*s}return[t,c,l]}function h(e){var t=+e[2]|+e[1]<<8|+e[0]<<16;return t="000000"+t.toString(16),t.slice(-6)}function d(e){return p(f(e))}function f(e){return 3===e.length&&(e=e.replace(/./g,"$&$&")),[s(e[0]+e[1],16),s(e[2]+e[3],16),s(e[4]+e[5],16)]}function m(e){return[+e[0]/360,+e[1]/100,+e[2]/100]}function v(e){return[c(360*+e[0]),c(100*+e[1]),c(100*+e[2])]}function w(e){return[+e[0]/255,+e[1]/255,+e[2]/255]}function E(e){if(r(e))return e;var t=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(e),n=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(e),o="#"===e[0]&&e.match(/^#([\da-f]{3}|[\da-f]{6})$/i);return o?d(e.slice(1)):n?m([+n[1],+n[2],+n[3]]):t?p([+t[1],+t[2],+t[3]]):[0,1,1]}var g,T="__instance__",b="firstChild",y="scrollRight",O="scrollTop",R="offsetLeft",H="offsetTop",x=setTimeout,A={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return A.Android()||A.BlackBerry()||A.iOS()||A.Opera()||A.Windows()}};g=e.CP=function(s,c){function p(e,t,n){e=e.split(/\s+/);for(var o=0,r=e.length;o<r;++o)t.addEventListener(e[o],n,!1)}function h(e,t,n){e=e.split(/\s+/);for(var o=0,r=e.length;o<r;++o)t.removeEventListener(e[o],n)}function d(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,o=t.touches?t.touches[0].pageY:t.pageY,r=f(e);return{x:n-r.l,y:o-r.t}}function f(t){if(t===e)var n=e.pageYOffset||V[O],o=e.pageXOffset||V[y];else for(n=t[H],o=t[R];t=t.offsetParent;)n+=t[H],o+=t[R];return{l:o,t:n}}function m(e,t){for(;(e=e.parentElement)&&e!==t;);return e}function v(e){e&&e.preventDefault()}function w(t){return t===e?{w:e.innerWidth,h:e.innerHeight}:{w:t.offsetWidth,h:t.offsetHeight}}function E(e){return I||!!n(e)&&e}function g(e){I=e}function $(e,t,o){return n(e)?n(t)?(n(j[e])||(j[e]={}),n(o)||(o=i(j[e])),j[e][o]=t,D):j[e]:j}function M(e,t){return n(e)?n(t)?(delete j[e][t],D):(j[e]={},D):(j={},D)}function L(e,t,o){if(!n(j[e]))return D;if(n(o))n(j[e][o])&&j[e][o].apply(D,t);else for(var r in j[e])j[e][r].apply(D,t);return D}function P(e,t){e&&"h"!==e||L("change:h",t),e&&"sv"!==e||L("change:sv",t),L("change",t)}function k(){return B.parentNode}function S(n,o){function r(e){l(Q);var t=l([Q[0],1,1]);K.style.backgroundColor="rgb("+t.join(",")+")",g(Q),v(e)}function i(e){var t=a(d(J,e).y,0,x);Q[0]=(x-t)/x,ee.style.top=t-V/2+"px",r(e)}function f(e){var t=d(K,e),n=a(t.x,0,$),o=a(t.y,0,M);Q[1]=1-($-n)/$,Q[2]=(M-o)/M,te.style.right=$-n-I/2+"px",te.style.top=o-j/2+"px",r(e)}function T(e){re&&(i(e),ue=u(Q),ne||(L("drag:h",[ue,D]),L("drag",[ue,D]),P("h",[ue,D]))),ie&&(f(e),ue=u(Q),oe||(L("drag:sv",[ue,D]),L("drag",[ue,D]),P("sv",[ue,D]))),ne=0,oe=0}function b(e){var t=e.target,n=re?"h":"sv",o=[u(Q),D],r=t===s||m(t,s)===s,i=t===B||m(t,B)===B;r||i?i&&(L("stop:"+n,o),L("stop",o),P(n,o)):k()&&!1!==c&&(D.exit(),L("exit",[D]),P(0,o)),re=0,ie=0}function y(e){ne=1,re=1,T(e),v(e),L("start:h",[ue,D]),L("start",[ue,D]),P("h",[ue,D])}function O(e){oe=1,ie=1,T(e),v(e),L("start:sv",[ue,D]),L("start",[ue,D]),P("sv",[ue,D])}n||((o||z).appendChild(B),D.visible=!0),ce=w(B).w,le=w(B).h;var R=w(K),H=w(te),x=w(J).h,$=R.w,M=R.h,V=w(ee).h,I=H.w,j=H.h;if(n){function q(e){var t=e.target,n=t===s||m(t,s)===s;n&&!D.visible?S():D.exit(),L(n?"enter":"exit",[D])}B.style.right=B.style.top="-9999px",!1!==c&&p(c,s,q),D.create=function(){return S(1),L("create",[D]),D},D.destroy=function(){return!1!==c&&h(c,s,q),D.exit(),g(!1),L("destroy",[D]),D}}else N();Z=function(){Q=E(Q),r(),ee.style.top=x-V/2-x*+Q[0]+"px",te.style.right=$-I/2-$*+Q[1]+"px",te.style.top=M-j/2-M*+Q[2]+"px"},D.exit=function(n){return k()&&(k().removeChild(B),D.visible=!1),A.any()?(h(X,J,y),h(X,K,O),h(F,t,T),h(W,t,b)):(h(U,J,y),h(U,K,O),h(_,t,T),h(Y,t,b)),h(G,e,N),h(on_orientationchange,e,C),D},Z(),n||(A.any()?(p(X,J,y),p(X,K,O),p(F,t,T),p(W,t,b)):(p(U,J,y),p(U,K,O),p(_,t,T),p(Y,t,b)),p(G,e,N),p(on_orientationchange,e,C))}function C(){new Promise(function(e){setTimeout(e,500)}).then(function(){return D.fit()})}function N(){return D.fit()}var z=t.body,V=t.documentElement,D=this,I=!1,j={},B=t.createElement("div"),U="mousedown",X="touchstart",_="mousemove",F="touchmove",Y="mouseup",W="touchend",G="resize";if(on_orientationchange="orientationchange",!(D instanceof CP))return new CP(s,c);CP[T][s.id||s.name||i(CP[T])]=D,n(c)||(c=U),g(CP.parse(s.getAttribute("data-color")||s.value||[0,1,1])),B.className="color-picker",B.innerHTML='<div class="color-picker-control"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var Z,q=B[b].children,Q=E([0,1,1]),J=q[0],K=q[1],ee=J[b],te=K[b],ne=0,oe=0,re=0,ie=0,ae=0,se=0,ce=0,le=0,ue=u(Q);return S(1),x(function(){var e=[u(Q),D];L("create",e),P(0,e)},0),D.fit=function(t){var o=w(e),i=w(V),a=i.h>o.h,c=f(e),l=(f(V),a?i.w:o.w+c.l),u=a?o.h+c.t:Math.max(i.h,o.h),p=f(s);return ae=p.l,se=p.t+w(s).h,r(t)?(n(t[0])&&(ae=t[0]),n(t[1])&&(se=t[1])):(ae+ce>l&&(ae=l-ce),se+le>u&&(se=u-le)),B.style.right="65px",B.style.top=se-35+"px",L("fit",[D]),D},D.set=function(e){return n(e)?(o(e)&&(e=CP.parse(e)),g(e),Z(),D):E()},D.target=s,D.picker=B,D.visible=!1,D.on=$,D.off=M,D.trigger=L,D.hooks=j,D.enter=function(e){return S(0,e)},D},g.version="1.3.3",g[T]={},g.each=function(e,t){return x(function(){var t,n=g[T];for(t in n)e(n[t],t,n)},0===t?0:t||1),g},g.parse=E,g._HSV2RGB=l,g._HSV2HEX=u,g._RGB2HSV=p,g._HEX2HSV=d,g._HEX2RGB=function(e){return w(f(e))},g.HSV2RGB=function(e){return l(m(e))},g.HSV2HEX=function(e){return u(m(e))},g.RGB2HSV=function(e){return v(p(e))},g.RGB2HEX=h,g.HEX2HSV=function(e){return v(d(e))},g.HEX2RGB=f}(window,document),THREE.OrbitControls=function(e,t){function n(e){e.preventDefault()}function o(e){e.preventDefault(),e.button===p.mouseControls.ROTATE?(T.set(e.clientX,e.clientY),d=h.ROTATE):e.button===p.mouseControls.ZOOM?(w.set(e.clientX,e.clientY),d=h.ZOOM):e.button===p.mouseControls.PAN&&(O.set(e.clientX,e.clientY),d=h.PAN),d!==h.NONE&&(document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",i,!1))}function r(e){e.preventDefault(),d===h.ROTATE?(b.set(e.clientX,e.clientY),y.subVectors(b,T),m.theta-=2*Math.PI*y.x/t.clientWidth*p.rotateSpeed,m.phi-=2*Math.PI*y.y/t.clientHeight*p.rotateSpeed,T.copy(b)):d===h.ZOOM?(E.set(e.clientX,e.clientY),g.subVectors(E,w),g.y>0?v/=Math.pow(.95,p.zoomSpeed):g.y<0&&(v*=Math.pow(.95,p.zoomSpeed)),w.copy(E)):d===h.PAN&&(R.set(e.clientX,e.clientY),H.subVectors(R,O),A(H.x,H.y),O.copy(R)),p.update()}function i(e){document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",i,!1),d=h.NONE}function a(e){d!==h.NONE&&d!==h.ROTATE||(e.preventDefault(),e.stopPropagation(),e.deltaY<0?v*=Math.pow(.95,p.zoomSpeed):e.deltaY>0&&(v/=Math.pow(.95,p.zoomSpeed)),p.update())}function s(e){if(1===e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY),d=h.TOUCH_ROTATE;else if(2===e.touches.length){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;w.set(0,Math.sqrt(t*t+n*n)),d=h.TOUCH_ZOOM}else 3===e.touches.length?(O.set(e.touches[0].pageX,e.touches[0].pageY),d=h.TOUCH_PAN):d=h.NONE}function c(e){if(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&d===h.TOUCH_ROTATE)b.set(e.touches[0].pageX,e.touches[0].pageY),y.subVectors(b,T),m.theta-=2*Math.PI*y.x/t.clientWidth*p.rotateSpeed,m.phi-=2*Math.PI*y.y/t.clientHeight*p.rotateSpeed,T.copy(b);else if(2===e.touches.length&&d===h.TOUCH_ZOOM){var n=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;E.set(0,Math.sqrt(n*n+o*o)),g.subVectors(E,w),g.y>0?v*=Math.pow(.95,p.zoomSpeed):g.y<0&&(v/=Math.pow(.95,p.zoomSpeed)),w.copy(E)}else 3===e.touches.length&&d===h.TOUCH_PAN?(R.set(e.touches[0].pageX,e.touches[0].pageY),H.subVectors(R,O),A(H.x,H.y),O.copy(R)):d=h.NONE;p.update()}function l(e){d=h.NONE}function u(e){switch(e.keyCode){case p.keyboardControls.ROTATEUP:m.phi-=p.rotateSpeed/4;break;case p.keyboardControls.ROTATEDOWN:m.phi+=p.rotateSpeed/4;break;case p.keyboardControls.ROTATELEFT:m.theta-=p.rotateSpeed/4;break;case p.keyboardControls.ROTATERIGHT:m.theta+=p.rotateSpeed/4;break;case p.keyboardControls.ZOOMIN:v*=Math.pow(.95,2*p.zoomSpeed);break;case p.keyboardControls.ZOOMOUT:v/=Math.pow(.95,2*p.zoomSpeed);break;case p.keyboardControls.PANUP:A(0,-p.panSpeed);break;case p.keyboardControls.PANDOWN:A(0,p.panSpeed);break;case p.keyboardControls.PANLEFT:A(-p.panSpeed,0);break;case p.keyboardControls.PANRIGHT:A(p.panSpeed,0)}p.update()}this.object=e,this.renderer=t,this.pivot=new THREE.Vector3,this.zoomMin=2,this.zoomMax=800,this.zoomSpeed=.5,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.rotateSpeed=1,this.panSpeed=7,this.mouseControls={ROTATE:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.keyboardControls={ZOOMIN:90,ZOOMOUT:88,PANLEFT:65,PANUP:87,PANRIGHT:68,PANDOWN:83,ROTATELEFT:37,ROTATEUP:38,ROTATERIGHT:39,ROTATEDOWN:40},this.pivotReset=this.pivot.clone(),this.positionReset=this.object.position.clone(),this.zoomReset=this.object.zoom,this.update=function(){var t=new THREE.Vector3,n=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),o=n.clone().inverse(),r=p.object.position;t.copy(r).sub(p.pivot),t.applyQuaternion(n),f.setFromVector3(t),f.theta+=m.theta,f.phi+=m.phi,f.theta=Math.max(p.minAzimuthAngle,Math.min(p.maxAzimuthAngle,f.theta)),f.phi=Math.max(p.minPolarAngle,Math.min(p.maxPolarAngle,f.phi)),f.makeSafe(),f.radius=Math.max(p.zoomMin,Math.min(p.zoomMax,f.radius*v)),p.pivot.add(x),t.setFromSpherical(f),t.applyQuaternion(o),r.copy(p.pivot).add(t),p.object.lookAt(p.pivot),m.set(0,0,0),v=1,x.set(0,0,0)},this.reset=function(){p.pivot.copy(p.pivotReset),p.object.position.copy(p.positionReset),p.object.zoom=p.zoomReset,p.update(),d=h.NONE};var p=this,h={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5},d=h.NONE,f=new THREE.Spherical,m=new THREE.Spherical,v=1,w=new THREE.Vector2,E=new THREE.Vector2,g=new THREE.Vector2,T=new THREE.Vector2,b=new THREE.Vector2,y=new THREE.Vector2,O=new THREE.Vector2,R=new THREE.Vector2,H=new THREE.Vector2,x=new THREE.Vector3,A=function(e,n){var o=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3;o.copy(p.object.position).sub(p.pivot);var a=o.length();a*=Math.tan(p.object.fov/2*Math.PI/180),r.setFromMatrixColumn(p.object.matrix,0),i.setFromMatrixColumn(p.object.matrix,1),r.multiplyScalar(-2*e*a/t.clientHeight),i.multiplyScalar(2*n*a/t.clientHeight),x.add(r),x.add(i)};p.renderer.addEventListener("contextmenu",n,!1),p.renderer.addEventListener("mousedown",o,!1),p.renderer.addEventListener("wheel",a,!1),p.renderer.addEventListener("touchstart",s,!1),p.renderer.addEventListener("touchend",l,!1),p.renderer.addEventListener("touchmove",c,!1),window.addEventListener("keydown",u,!1),this.update()},$(function(){controller3D=new controller3D,controller3D.init()}),$(function(){$(window).resize(function(){$(".help.wrapper .help.menu").css("left",(window.innerWidth-$(".help.wrapper .help.menu").innerWidth())/2)}),$(window).on("orientationchange",function(){setTimeout(function(){$(".help.wrapper .help.menu").css("left",(window.innerWidth-$(".help.wrapper .help.menu").innerWidth())/2)},500)}),$(".navbar.right .help.icon").click(function(e){e.preventDefault(),$(".help.wrapper").fadeIn("slow"),$(".help.wrapper .help.menu").css("left",(window.innerWidth-$(".help.wrapper .help.menu").innerWidth())/2),setTimeout(function(){$(".help.content").scrollTop(0),$(".help.content").scrollLeft(0)},10)}),$(".help.wrapper .help.leftover, .help.wrapper .help.menu .exitButton").on("mousedown touchstart",function(e){e.preventDefault(),$(".help.wrapper").fadeOut("slow")})}),$(function(){const e="This applications is a 3D object previewer that allows users to interact and carry out certain basic operations on loaded objects, enabling their analysis in detail.<br>In addition, the application stores the extracted and processed geometry of the objects, so that they can be easily loaded again.<br>The main interface has two buttons:<br>&nbsp;&#8226; The upper right button allows the user to load STL, OBJ or PLY files to process them on the server and display them on the interface.<br>&nbsp;&#8226; The upper left button displays a list of the files processed and stored in the server, allowing the user to request the stored geometry.<br>Once the 3D object is displayed in the interface, the user can perform basic operations such as rotation, padding or zooming.";$("<p>"+e+"</p>").appendTo("#projectIntroText"),$(window).on("click touchstart",function(e){$("#projectIntroContainer").is(":visible")&&($(e.target).is("#projectIntroContainer")||$(e.target).is("#projectIntroExit"))&&$("#projectIntroContainer").fadeOut("slow")})});